<!--
 * @Author: 秦琛
 * @LastEditors: 秦琛
 * @description: 公共头部导航
 * @Date: 2022-05-09 09:48:25
 * @LastEditTime: 2022-05-10 09:51:15
-->
<link rel="stylesheet" href="/css/header.css">
<div class="header">
  <div class="header-main">
    <!-- logo -->
    <div class="logo">
      <img src="/images/tq_logo.png" alt="天启HTTP" title="天启HTTP">
      <span class="logo-title box-border">天启HTTP</span>
    </div>
    <!-- 中间导航 -->
    <nav class="nav-wrap">
      <!-- 双态icon -->
      <div class="nav-toggler">
        <span>显示</span>
      </div>

      <div class="navbar-body nav-collapse">
        <ul class="nav-list">
          <li class="nav-item box-border">
            首页
          </li>
          <li class="nav-item box-border">礼券管理</li>
          <li class="nav-item box-border">套餐购买</li>
          <li class="nav-item box-border">提取IP</li>
          <li class="nav-item box-border">业务场景</li>
          <li class="nav-item box-border">帮助中心</li>
          <li class="nav-item box-border">企业服务</li>
        </ul>
      </div>

    </nav>
    <!-- 右侧按钮/登录信息 -->
    <div class="user">
      <%=name %>
    </div>
  </div>
  <%- include('../components/js.html'); %>
</div>
<!-- <script src="../../static/js/header/index.js"></script> -->
<script>
  $(function () {
    let resizeTimer = null;
    function toggleHead () {
      const headerAttr = {
        allWidth: 0,
        mainWidth: 0,  // 所有导航子元素加起来的宽度
        itemWidth: 0,  // 导航子元素宽度 + padding + margin
        logoWidth: 0,  // logo区域宽度
        navRightWidth: 0,  // 右侧登陆注册区域宽度
      }

      let windowWidth = $(window).width();
      headerAttr.logoWidth = $('.header-main .logo').outerWidth(true);
      headerAttr.navRightWidth = $('.header-main .user').outerWidth(true);

      const domTree = $('.header-main .nav-list .nav-item');
      domTree.each(function (index) {
        headerAttr.itemWidth = $(this).outerWidth(true);
        headerAttr.mainWidth += headerAttr.itemWidth
      })

      headerAttr.allWidth = headerAttr.logoWidth + headerAttr.navRightWidth + headerAttr.mainWidth;
      console.log(headerAttr.allWidth, 'headerAttr.allWidth');
      // if (windowWidth < 868) {
      //   $('.header-main .nav-list').siblings().addClass('show')
      // } else {
      //   $('.header-main .nav-list').siblings().removeClass('show')
      // }
    }
    toggleHead();

    $('.nav-toggler').click(function () {
      if ($('.header-main .navbar-body').hasClass('show')) {
        console.log('添加');
        $('.header-main .navbar-body').removeClass('show')
      } else {
        console.log('移除');
        $('.header-main .navbar-body').addClass('show')
      }

    })

    window.onresize = function () {
      if (resizeTimer) {
        clearTimeout(resizeTimer);
      }
      // //再重新开始下一轮等待
      resizeTimer = setTimeout(function () {
        toggleArea();
      }, 200);
    }
  })
</script>