<!--
 * @Author: 秦琛
 * @LastEditors: 朱占伟
 * @description: 公共头部导航
 * @Date: 2022-05-09 09:48:25
 * @LastEditTime: 2022-05-16 18:27:16
-->
<link rel="stylesheet" href="/css/header.css">
<div class="header">
  <div class="header-main align-center">
    <!-- logo -->
    <div class="logo align-center mr-20">
      <img src="/images/tq_logo.png" alt="天启HTTP" title="天启HTTP">
      <span class="logo-title box-border ml-10">天启HTTP</span>
    </div>
    <!-- 中间导航 -->
    <nav class="nav-wrap">
      <div class="nav-body">
        <ul class="nav-list">
          <li class="nav-item box-border">
            <a href="/" title="首页">首页</a>
          </li>
          <li class="nav-item box-border">
            <a href="/getIp" title="礼券管理">礼券管理</a>
          </li>
          <li class="nav-item box-border nav-meal">
            <a href="/package" title="套餐购买">
              <span>套餐购买</span>
              <i class="iconfont icon-arrow-down"></i>
            </a>
            <!-- 子导航 -->
            <ul class="child-list flex-center">
              <li class="child-item">
                <div class="title flex-center justify-start">
                  <span class="meal-icon icon_first"></span>
                  <span class="title-type">余额套餐</span>
                  <% if(HEADER_ACTIVE_TAB && HEADER_ACTIVE_TAB.maxRechargeGift) { %>
                    <div class="activity">
                      加赠<%= HEADER_ACTIVE_TAB.maxRechargeGift %>%
                    </div>
                    <% } else { %>
                      <span>333</span>
                      <% } %>
                </div>
                <span class="describe">
                  余额充值提取，自定义IP时效地区、数量
                </span>
              </li>

              <li class="child-item">
                <div class="title flex-center justify-start">
                  <span class="meal-icon icon_second"></span>
                  <span class="title-type">包时套餐</span>
                  <% if(HEADER_ACTIVE_TAB && HEADER_ACTIVE_TAB.minPurchaseRate) { %>
                    <div class="activity">
                      限时<%= HEADER_ACTIVE_TAB.minPurchaseRate %>折
                    </div>
                    <% } else { %>
                      <span></span>
                      <% } %>
                </div>
                <span class="describe">
                  每日固定IP提取量，3 / 5 / 10 /15 分钟时效IP
                </span>
              </li>
            </ul>
          </li>

          <li class="nav-item box-border nav-ip">
            <a href="/getIp" title="提取IP">
              <span>提取IP</span>
              <i class="iconfont icon-arrow-down"></i>
            </a>

            <!-- 子导航 -->
            <ul class="child-list flex-center child-vertical">
              <li class="child-item">
                <div class="title flex-center justify-start">
                  <span class="meal-icon icon_third"></span>
                  <span class="title-type">API提取</span>
                </div>
              </li>

              <li class="child-item">
                <div class="title flex-center justify-start">
                  <span class="meal-icon icon_forth"></span>
                  <span class="title-type">代码demo</span>
                </div>
              </li>
            </ul>
          </li>

          <li class="nav-item box-border nav-business">
            <a href="/businessScene" title="业务场景">
              <span>业务场景</span>
              <i class="iconfont icon-arrow-down"></i>
            </a>

            <!-- 子导航 -->
            <ul class="child-list flex-center mixed-range">
              <li class="child-item">
                <div class="meal-icon nav_first"></div>
                <div class="content">
                  <span class="title-type">市场调查</span>
                  <span class="describe">
                    收集全网行业数据，
                    了解竞争对手动态
                  </span>
                </div>
              </li>

              <li class="child-item">
                <div class="meal-icon nav_second"></div>
                <div class="content">
                  <span class="title-type">社交采集</span>
                  <span class="describe">
                    采集社交媒体数据，
                    为企业提供支持
                  </span>
                </div>
              </li>

              <li class="child-item">
                <div class="meal-icon nav_third"></div>
                <div class="content">
                  <span class="title-type">品牌保护</span>
                  <span class="describe">
                    保护品牌商标打造，
                    优质品牌形象
                  </span>
                </div>
              </li>

              <li class="child-item">
                <div class="meal-icon nav_forth"></div>
                <div class="content">
                  <span class="title-type">SEO情报</span>
                  <span class="describe">
                    收集搜索引擎情报，
                    提升品牌收益
                  </span>
                </div>
              </li>

              <li class="child-item">
                <div class="meal-icon nav_fifth"></div>
                <div class="content">
                  <span class="title-type">电子商务</span>
                  <span class="describe">
                    淘宝、京东、拼多
                    多等电商平台抢购
                  </span>
                </div>
              </li>

              <li class="child-item">
                <div class="meal-icon nav_sixth"></div>
                <div class="content">
                  <span class="title-type">价格监控</span>
                  <span class="describe">
                    利用优质代理IP监
                    控行业动态价格
                  </span>
                </div>

              </li>
            </ul>
          </li>

          <li class="nav-item box-border nav-help">
            <a href="/helpCenter" title="帮助中心">
              <span>帮助中心</span>
              <i class="iconfont icon-arrow-down"></i>
            </a>

            <!-- 子导航 -->
            <ul class="child-list flex-center child-vertical">
              <li class="child-item">
                <div class="title flex-center justify-around">
                  <span class="meal-icon icon_fifth"></span>
                  <span class="title-type">操作手册</span>
                </div>
              </li>

              <li class="child-item">
                <div class="title flex-center justify-around">
                  <span class="meal-icon icon_sixth"></span>
                  <span class="title-type">产品介绍</span>
                </div>
              </li>
              <li class="child-item">
                <div class="title flex-center justify-around">
                  <span class="meal-icon icon_seventh"></span>
                  <span class="title-type">行业资讯</span>
                </div>
              </li>
            </ul>
          </li>
          <li class="nav-item box-border">
            <a href="/firmsServer" title="企业服务">
              <span>企业服务</span>
            </a>
          </li>
        </ul>
      </div>


      <!-- 双态icon -->
      <div class="nav-toggler">
        <span>显示</span>
      </div>
    </nav>
    <!-- 右侧按钮/登录信息 -->
    <div class="user btn">
      <% if(name) { %>
        <div class="default-btn button person-center">
          <a href="/manager/user" title="个人中心">个人中心</a>
        </div>
        <div class="bl-l-button button user-register">
          <span>退出</span>
        </div>
        <% } else { %>
          <div class="bl-button button user-login">
            <span>登录</span>
          </div>
          <div class="or-button button user-register">
            <span>注册</span>
          </div>
          <% } %>
    </div>
  </div>
</div>
<!-- controller manager部分 fs模块引入ejs %- 路径找不到，暂时解决办法 -->
<!-- !!!   在这加模块 -->
<script src="/lib/js/jquery-3.5.1.min.js"></script>
<script src="/lib/js/bootstrap.min.js"></script>
<script src="/lib/js/popper.min.js"></script>
<script src="/lib/js/utils.js"></script>
<script src="/lib/js/ajax.js"></script>
<!-- IMPORT JS END -->
<!-- <script src="./js.html"></script> -->
<script>
  $(function () {
    let resizeTimer = null;
    let headerAttr = {
      allWidth: 0,
      mainWidth: 0,  // 所有导航子元素加起来的宽度
      itemWidth: 0,  // 导航子元素宽度 + padding + margin
      logoWidth: 0,  // logo区域宽度
      navRightWidth: 0,  // 右侧登陆注册区域宽度
    }
    function toggleHead() {
      // 每次调用重置
      headerAttr = {
        allWidth: 0,
        mainWidth: 0,  // 所有导航子元素加起来的宽度
        itemWidth: 0,  // 导航子元素宽度 + padding + margin
        logoWidth: 0,  // logo区域宽度
        navRightWidth: 0,  // 右侧登陆注册区域宽度
      }

      let windowWidth = $(window).width();
      headerAttr.logoWidth = $('.header-main .logo').outerWidth(true);
      headerAttr.navRightWidth = $('.header-main .user').outerWidth(true);

      const domTree = $('.header-main .nav-list .nav-item');
      domTree.each(function (index) {
        headerAttr.itemWidth = $(this).outerWidth(true);
        headerAttr.mainWidth += headerAttr.itemWidth
      })

      headerAttr.allWidth = headerAttr.logoWidth + headerAttr.navRightWidth + headerAttr.mainWidth;
      console.log(headerAttr.allWidth, 'headerAttr.allWidth');
      console.log(headerAttr.mainWidth, '中间导航');
    }
    toggleHead();

    $('.nav-toggler').click(function () {
      if ($('.header-main .nav-body').hasClass('show')) {
        $('.header-main .nav-body').removeClass('show')
      } else {
        $('.header-main .nav-body').addClass('show');
        $('.header-main .nav-body .nav-list').addClass('adjust_position').css("margin-right", headerAttr.navRightWidth - 10)
      }

    })

    window.onresize = function () {
      if (resizeTimer) {
        clearTimeout(resizeTimer);
      }
      // //再重新开始下一轮等待
      resizeTimer = setTimeout(function () {
        toggleHead();
      }, 200);
    }
  })
</script>